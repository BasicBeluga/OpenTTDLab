---
title: 'OpenTTDLab: A Python framework for reproducible experiments using OpenTTD'
tags:
  - Python
authors:
  - name: Michal Charemza
    orcid: 0009-0009-1002-1036
    affiliation: 1
affiliations:
 - name: University of Edinburgh, United Kingdom
   index: 1
   ror: 01nrxwf90
date: 8 December 2024
bibliography: paper.bib

---

# Summary

OpenTTD [@openttdteam2004openttd] is a business simulation game originally created for recreation, where one or more human players build companies through constructing and using a transportation network to transport passengers and goods. OpenTTD can be extended by allowing autonomous so-called AI players, and it is by leveraging this capability, allowing researchers to run experiments with their own AIs, that OpenTTDLab converts OpenTTD from a game into a system for researching algorithms and their effects on companies and supply chains, and helps to ensure the results of such research are reproducible.

![The OpenTTDLab logo. Adapted from the OpenTTD Logo, Â© OpenTTD Team, licenced under the GNU General Public License Version 2.](openttdlab-logo.pdf){height="100pt"}

# Statement of need

OpenTTD is remarkably flexible: by leveraging the OpenTTD AI system it has been successfully used as a tool to research algorithms including artificial intelligence (AI), machine learning (ML), and anomaly detection algorithms [@beuneker2019autonomous; @bijlsma2014evolving; @konijnendijk2015mcts; @lakomy2020railroad; @rios2009trains; @wisniewski2011artificial; @volna2017fuzzy]. However, OpenTTD does not include the capability to easily repeat experiments over ranges of configuration--unsurprising since it is designed to be a game--and this results in much of the existing research not being able to be reproduced [@charemza2024reusable, chap. 1]. OpenTTD addresses this by providing a framework through which experiments similar to those of the existing literature can be easily run by writing and running Python code, and encourages such code to be shared so future researchers can easily reproduce results.

There appears to be no open source framework that takes a game designed for recreation and converts it into a reusable simulator for reproducible research, and in this respect OpenTTDLab is novel. The closest equivalent found is Axelrod [@knight2016open], a Python framework that research into the Iterated Prisoner's dilema, allowing researchers to investigate existing and new strategies of playing the game. Similar to OpenTTDLab, Axelrod was created in response to existing research being found to not be reproducible.

# Usage and results

Through a single Python function call, `run_experiments`, OpenTTDLab runs OpenTTD over a range of configurations, most typically over a range of random seeds and range of parameters of an AI; it then returns data from every month of in-game time, which can be processed and visualised. \autoref{fig:example-results} shows example results: comparing how the distributions of money in the bank change over time for two configurations of a simple AI that builds a single bus route with a configurable number of buses.

![How the distribution of money in the bank changes over time for a simple AI [@charemza2024parameterised]. The results of 100 runs of OpenTTD are shown, 50 when the AI is configured to build 1 bus, and 50 for when it is configured to build 16 buses. The results are generated by a single call to OpenTTDLab's `run_experiments` function. Image adapted from [@charemza2024reusable, chap. 5].\label{fig:example-results}](example-results-charemza2004reproducible){height="150pt"}

# Acknowledgments

OpenTTDLab could not have been created without incredible work of all the [contributors to OpenTTD, its dependencies, and precursors](https://github.com/OpenTTD/OpenTTD/blob/master/CREDITS.md); thank you to Patric Stout (A.K.A. TrueBrain), who originally wrote the OpenTTD savegame parser that OpenTTDLab forked from; and finally, thank you to Michael Herrmann, whose advice from his supervision of the dissertation that resulted in the original versions of OpenTTDLab [@charemza2024reusable] was invaluable.

# References
